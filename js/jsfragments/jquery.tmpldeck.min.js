/* jQuery.TmplDeck | author: Takeshi Takatsudo / repo: https://github.com/Takazudo/jQuery.TmplDeck */
(function(a,b,c,d,e){d.TmplDeck=function(b,c){if(this instanceof arguments.callee)this._options=a.extend({},this._options,c,{url:b}),this._fetchDefer=a.Deferred(),this._cache={};else return new d.TmplDeck(b,c)},d.TmplDeck.prototype={_options:{dataType:"text",url:null,cache:!0},_fetchedText:null,_fetchDefer:null,_cache:null,load:function(){var b=this;return a.ajax(b._options).then(function(a){b._fetchedText=a,b._fetchDefer.resolve()},function(){alert("ajax failed")})},ready:function(a){this._fetchDefer.done(function(){a()})},draw:function(a){if(this._cache[a])ret=this._cache[a];else{var b=new RegExp("(^|\\n)"+a+"\\s{{{\\r?\\n([\\s\\S]+?)}}}"),c=this._fetchedText.match(b);ret=c?this._cache[a]=c[2]:null}return ret}},d.TmplDeck.prototype.tmpl=function(a,b){return _.template(this.draw(a))(b)}})(jQuery,this,this.document,jQuery);
