/*
 * jQuery Easing v1.3 - http://gsgd.co.uk/sandbox/jquery/easing/
 *
 * Uses the built in easing capabilities added In jQuery 1.1
 * to offer multiple easing options
 *
 * TERMS OF USE - jQuery Easing
 * 
 * Open source under the BSD License. 
 * 
 * Copyright © 2008 George McGinley Smith
 * All rights reserved.
 * 
 * Redistribution and use in source and binary forms, with or without modification, 
 * are permitted provided that the following conditions are met:
 * 
 * Redistributions of source code must retain the above copyright notice, this list of 
 * conditions and the following disclaimer.
 * Redistributions in binary form must reproduce the above copyright notice, this list 
 * of conditions and the following disclaimer in the documentation and/or other materials 
 * provided with the distribution.
 * 
 * Neither the name of the author nor the names of contributors may be used to endorse 
 * or promote products derived from this software without specific prior written permission.
 * 
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY 
 * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE
 *  COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
 *  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE
 *  GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED 
 * AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 *  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED 
 * OF THE POSSIBILITY OF SUCH DAMAGE. 
 *
*/// t: current time, b: begInnIng value, c: change In value, d: duration
jQuery.easing.jswing=jQuery.easing.swing,jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(a,b,c,d,e){return jQuery.easing[jQuery.easing.def](a,b,c,d,e)},easeInQuad:function(a,b,c,d,e){return d*(b/=e)*b+c},easeOutQuad:function(a,b,c,d,e){return-d*(b/=e)*(b-2)+c},easeInOutQuad:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b+c:-d/2*(--b*(b-2)-1)+c},easeInCubic:function(a,b,c,d,e){return d*(b/=e)*b*b+c},easeOutCubic:function(a,b,c,d,e){return d*((b=b/e-1)*b*b+1)+c},easeInOutCubic:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b*b+c:d/2*((b-=2)*b*b+2)+c},easeInQuart:function(a,b,c,d,e){return d*(b/=e)*b*b*b+c},easeOutQuart:function(a,b,c,d,e){return-d*((b=b/e-1)*b*b*b-1)+c},easeInOutQuart:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b*b*b+c:-d/2*((b-=2)*b*b*b-2)+c},easeInQuint:function(a,b,c,d,e){return d*(b/=e)*b*b*b*b+c},easeOutQuint:function(a,b,c,d,e){return d*((b=b/e-1)*b*b*b*b+1)+c},easeInOutQuint:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b*b*b*b+c:d/2*((b-=2)*b*b*b*b+2)+c},easeInSine:function(a,b,c,d,e){return-d*Math.cos(b/e*(Math.PI/2))+d+c},easeOutSine:function(a,b,c,d,e){return d*Math.sin(b/e*(Math.PI/2))+c},easeInOutSine:function(a,b,c,d,e){return-d/2*(Math.cos(Math.PI*b/e)-1)+c},easeInExpo:function(a,b,c,d,e){return b==0?c:d*Math.pow(2,10*(b/e-1))+c},easeOutExpo:function(a,b,c,d,e){return b==e?c+d:d*(-Math.pow(2,-10*b/e)+1)+c},easeInOutExpo:function(a,b,c,d,e){return b==0?c:b==e?c+d:(b/=e/2)<1?d/2*Math.pow(2,10*(b-1))+c:d/2*(-Math.pow(2,-10*--b)+2)+c},easeInCirc:function(a,b,c,d,e){return-d*(Math.sqrt(1-(b/=e)*b)-1)+c},easeOutCirc:function(a,b,c,d,e){return d*Math.sqrt(1-(b=b/e-1)*b)+c},easeInOutCirc:function(a,b,c,d,e){return(b/=e/2)<1?-d/2*(Math.sqrt(1-b*b)-1)+c:d/2*(Math.sqrt(1-(b-=2)*b)+1)+c},easeInElastic:function(a,b,c,d,e){var f=1.70158,g=0,h=d;if(b==0)return c;if((b/=e)==1)return c+d;g||(g=e*.3);if(h<Math.abs(d)){h=d;var f=g/4}else var f=g/(2*Math.PI)*Math.asin(d/h);return-(h*Math.pow(2,10*(b-=1))*Math.sin((b*e-f)*2*Math.PI/g))+c},easeOutElastic:function(a,b,c,d,e){var f=1.70158,g=0,h=d;if(b==0)return c;if((b/=e)==1)return c+d;g||(g=e*.3);if(h<Math.abs(d)){h=d;var f=g/4}else var f=g/(2*Math.PI)*Math.asin(d/h);return h*Math.pow(2,-10*b)*Math.sin((b*e-f)*2*Math.PI/g)+d+c},easeInOutElastic:function(a,b,c,d,e){var f=1.70158,g=0,h=d;if(b==0)return c;if((b/=e/2)==2)return c+d;g||(g=e*.3*1.5);if(h<Math.abs(d)){h=d;var f=g/4}else var f=g/(2*Math.PI)*Math.asin(d/h);return b<1?-0.5*h*Math.pow(2,10*(b-=1))*Math.sin((b*e-f)*2*Math.PI/g)+c:h*Math.pow(2,-10*(b-=1))*Math.sin((b*e-f)*2*Math.PI/g)*.5+d+c},easeInBack:function(a,b,c,d,e,f){return f==undefined&&(f=1.70158),d*(b/=e)*b*((f+1)*b-f)+c},easeOutBack:function(a,b,c,d,e,f){return f==undefined&&(f=1.70158),d*((b=b/e-1)*b*((f+1)*b+f)+1)+c},easeInOutBack:function(a,b,c,d,e,f){return f==undefined&&(f=1.70158),(b/=e/2)<1?d/2*b*b*(((f*=1.525)+1)*b-f)+c:d/2*((b-=2)*b*(((f*=1.525)+1)*b+f)+2)+c},easeInBounce:function(a,b,c,d,e){return d-jQuery.easing.easeOutBounce(a,e-b,0,d,e)+c},easeOutBounce:function(a,b,c,d,e){return(b/=e)<1/2.75?d*7.5625*b*b+c:b<2/2.75?d*(7.5625*(b-=1.5/2.75)*b+.75)+c:b<2.5/2.75?d*(7.5625*(b-=2.25/2.75)*b+.9375)+c:d*(7.5625*(b-=2.625/2.75)*b+.984375)+c},easeInOutBounce:function(a,b,c,d,e){return b<e/2?jQuery.easing.easeInBounce(a,b*2,0,d,e)*.5+c:jQuery.easing.easeOutBounce(a,b*2-e,0,d,e)*.5+d*.5+c}});
/*!
 * twitter-text-js 1.4.16
 *
 * Copyright 2011 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this work except in compliance with the License.
 * You may obtain a copy of the License at:
 *
 *    http://www.apache.org/licenses/LICENSE-2.0
 */
if(typeof window=="undefined"||window===null)window={twttr:{}};window.twttr==null&&(window.twttr={});if(typeof twttr=="undefined"||twttr===null)twttr={};(function(){function b(a,b){return b=b||"",typeof a!="string"&&(a.global&&b.indexOf("g")<0&&(b+="g"),a.ignoreCase&&b.indexOf("i")<0&&(b+="i"),a.multiline&&b.indexOf("m")<0&&(b+="m"),a=a.source),new RegExp(a.replace(/#\{(\w+)\}/g,function(a,b){var c=twttr.txt.regexen[b]||"";return typeof c!="string"&&(c=c.source),c}),b)}function c(a,b){return a.replace(/#\{(\w+)\}/g,function(a,c){return b[c]||""})}function d(a,b,c){var d=String.fromCharCode(b);return c!==b&&(d+="-"+String.fromCharCode(c)),a.push(d),a}function o(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}function s(a,b,c){return c?!a||a.match(b)&&RegExp["$&"]===a:typeof a=="string"&&a.match(b)&&RegExp["$&"]===a}twttr.txt={},twttr.txt.regexen={};var a={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#39;"};twttr.txt.htmlEscape=function(b){return b&&b.replace(/[&"'><]/g,function(b){return a[b]})};var e=String.fromCharCode,f=[e(32),e(133),e(160),e(5760),e(6158),e(8232),e(8233),e(8239),e(8287),e(12288)];d(f,9,13),d(f,8192,8202);var g=[e(65534),e(65279),e(65535)];d(g,8234,8238),twttr.txt.regexen.spaces_group=b(f.join("")),twttr.txt.regexen.spaces=b("["+f.join("")+"]"),twttr.txt.regexen.invalid_chars_group=b(g.join("")),twttr.txt.regexen.punct=/\!'#%&'\(\)*\+,\\\-\.\/:;<=>\?@\[\]\^_{|}~\$/,twttr.txt.regexen.atSigns=/[@＠]/,twttr.txt.regexen.extractMentions=b(/(^|[^a-zA-Z0-9_!#$%&*@＠])(#{atSigns})([a-zA-Z0-9_]{1,20})/g),twttr.txt.regexen.extractReply=b(/^(?:#{spaces})*#{atSigns}([a-zA-Z0-9_]{1,20})/),twttr.txt.regexen.listName=/[a-zA-Z][a-zA-Z0-9_\-\u0080-\u00ff]{0,24}/,twttr.txt.regexen.extractMentionsOrLists=b(/(^|[^a-zA-Z0-9_!#$%&*@＠])(#{atSigns})([a-zA-Z0-9_]{1,20})(\/[a-zA-Z][a-zA-Z0-9_\-]{0,24})?/g);var h=[];d(h,1024,1279),d(h,1280,1319),d(h,11744,11775),d(h,42560,42655),d(h,1425,1469),d(h,1471,1471),d(h,1473,1474),d(h,1476,1477),d(h,1479,1479),d(h,1488,1514),d(h,1520,1522),d(h,64274,64296),d(h,64298,64310),d(h,64312,64316),d(h,64318,64318),d(h,64320,64321),d(h,64323,64324),d(h,64326,64335),d(h,1552,1562),d(h,1568,1631),d(h,1646,1747),d(h,1749,1756),d(h,1758,1768),d(h,1770,1775),d(h,1786,1788),d(h,1791,1791),d(h,1872,1919),d(h,2208,2208),d(h,2210,2220),d(h,2276,2302),d(h,64336,64433),d(h,64467,64829),d(h,64848,64911),d(h,64914,64967),d(h,65008,65019),d(h,65136,65140),d(h,65142,65276),d(h,8204,8204),d(h,3585,3642),d(h,3648,3662),d(h,4352,4607),d(h,12592,12677),d(h,43360,43391),d(h,44032,55215),d(h,55216,55295),d(h,65441,65500),d(h,12449,12538),d(h,12540,12542),d(h,65382,65439),d(h,65392,65392),d(h,65296,65305),d(h,65313,65338),d(h,65345,65370),d(h,12353,12438),d(h,12441,12446),d(h,13312,19903),d(h,19968,40959),d(h,173824,177983),d(h,177984,178207),d(h,194560,195103),d(h,12291,12291),d(h,12293,12293),d(h,12347,12347),twttr.txt.regexen.nonLatinHashtagChars=b(h.join(""));var i=[];d(i,192,214),d(i,216,246),d(i,248,255),d(i,256,591),d(i,595,596),d(i,598,599),d(i,601,601),d(i,603,603),d(i,611,611),d(i,616,616),d(i,623,623),d(i,626,626),d(i,649,649),d(i,651,651),d(i,699,699),d(i,7680,7935),twttr.txt.regexen.latinAccentChars=b(i.join("")),twttr.txt.regexen.endScreenNameMatch=b(/^(?:#{atSigns}|[#{latinAccentChars}]|:\/\/)/),twttr.txt.regexen.hashtagAlpha=b(/[a-z_#{latinAccentChars}#{nonLatinHashtagChars}]/i),twttr.txt.regexen.hashtagAlphaNumeric=b(/[a-z0-9_#{latinAccentChars}#{nonLatinHashtagChars}]/i),twttr.txt.regexen.endHashtagMatch=/^(?:[#＃]|:\/\/)/,twttr.txt.regexen.hashtagBoundary=b(/(?:^|$|[^&\/a-z0-9_#{latinAccentChars}#{nonLatinHashtagChars}])/),twttr.txt.regexen.autoLinkHashtags=b(/(#{hashtagBoundary})(#|＃)(#{hashtagAlphaNumeric}*#{hashtagAlpha}#{hashtagAlphaNumeric}*)/gi),twttr.txt.regexen.autoLinkUsernamesOrLists=/(^|[^a-zA-Z0-9_!#\$%&*@＠]|RT:?)([@＠]+)([a-zA-Z0-9_]{1,20})(\/[a-zA-Z][a-zA-Z0-9_\-]{0,24})?/g,twttr.txt.regexen.autoLinkEmoticon=/(8\-\#|8\-E|\+\-\(|\`\@|\`O|\&lt;\|:~\(|\}:o\{|:\-\[|\&gt;o\&lt;|X\-\/|\[:-\]\-I\-|\/\/\/\/Ö\\\\\\\\|\(\|:\|\/\)|∑:\*\)|\( \| \))/g,twttr.txt.regexen.validPrecedingChars=b(/(?:[^-\/"'!=A-Za-z0-9_@＠$#＃\.#{invalid_chars_group}]|^)/),twttr.txt.regexen.invalidDomainChars=c("#{punct}#{spaces_group}#{invalid_chars_group}",twttr.txt.regexen),twttr.txt.regexen.validDomainChars=b(/[^#{invalidDomainChars}]/),twttr.txt.regexen.validSubdomain=b(/(?:(?:#{validDomainChars}(?:[_-]|#{validDomainChars})*)?#{validDomainChars}\.)/),twttr.txt.regexen.validDomainName=b(/(?:(?:#{validDomainChars}(?:-|#{validDomainChars})*)?#{validDomainChars}\.)/),twttr.txt.regexen.validGTLD=b(/(?:(?:aero|asia|biz|cat|com|coop|edu|gov|info|int|jobs|mil|mobi|museum|name|net|org|pro|tel|travel|xxx)(?=[^a-zA-Z]|$))/),twttr.txt.regexen.validCCTLD=b(/(?:(?:ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cs|cu|cv|cx|cy|cz|dd|de|dj|dk|dm|do|dz|ec|ee|eg|eh|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|ss|st|su|sv|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|za|zm|zw)(?=[^a-zA-Z]|$))/),twttr.txt.regexen.validPunycode=b(/(?:xn--[0-9a-z]+)/),twttr.txt.regexen.validDomain=b(/(?:#{validSubdomain}*#{validDomainName}(?:#{validGTLD}|#{validCCTLD}|#{validPunycode}))/),twttr.txt.regexen.validAsciiDomain=b(/(?:(?:[a-z0-9#{latinAccentChars}]+)\.)+(?:#{validGTLD}|#{validCCTLD}|#{validPunycode})/gi),twttr.txt.regexen.invalidShortDomain=b(/^#{validDomainName}#{validCCTLD}$/),twttr.txt.regexen.validPortNumber=b(/[0-9]+/),twttr.txt.regexen.validGeneralUrlPathChars=b(/[a-z0-9!\*';:=\+,\.\$\/%#\[\]\-_~|&#{latinAccentChars}]/i),twttr.txt.regexen.validUrlBalancedParens=b(/\(#{validGeneralUrlPathChars}+\)/i),twttr.txt.regexen.validUrlPathEndingChars=b(/[\+\-a-z0-9=_#\/#{latinAccentChars}]|(?:#{validUrlBalancedParens})/i),twttr.txt.regexen.validUrlPath=b("(?:(?:#{validGeneralUrlPathChars}*(?:#{validUrlBalancedParens}#{validGeneralUrlPathChars}*)*#{validUrlPathEndingChars})|(?:@#{validGeneralUrlPathChars}+/))","i"),twttr.txt.regexen.validUrlQueryChars=/[a-z0-9!?\*'\(\);:&=\+\$\/%#\[\]\-_\.,~|]/i,twttr.txt.regexen.validUrlQueryEndingChars=/[a-z0-9_&=#\/]/i,twttr.txt.regexen.extractUrl=b("((#{validPrecedingChars})((https?:\\/\\/)?(#{validDomain})(?::(#{validPortNumber}))?(\\/#{validUrlPath}*)?(\\?#{validUrlQueryChars}*#{validUrlQueryEndingChars})?))","gi"),twttr.txt.regexen.validTcoUrl=/^https?:\/\/t\.co\/[a-z0-9]+/i,twttr.txt.regexen.validateUrlUnreserved=/[a-z0-9\-._~]/i,twttr.txt.regexen.validateUrlPctEncoded=/(?:%[0-9a-f]{2})/i,twttr.txt.regexen.validateUrlSubDelims=/[!$&'()*+,;=]/i,twttr.txt.regexen.validateUrlPchar=b("(?:#{validateUrlUnreserved}|#{validateUrlPctEncoded}|#{validateUrlSubDelims}|[:|@])","i"),twttr.txt.regexen.validateUrlScheme=/(?:[a-z][a-z0-9+\-.]*)/i,twttr.txt.regexen.validateUrlUserinfo=b("(?:#{validateUrlUnreserved}|#{validateUrlPctEncoded}|#{validateUrlSubDelims}|:)*","i"),twttr.txt.regexen.validateUrlDecOctet=/(?:[0-9]|(?:[1-9][0-9])|(?:1[0-9]{2})|(?:2[0-4][0-9])|(?:25[0-5]))/i,twttr.txt.regexen.validateUrlIpv4=b(/(?:#{validateUrlDecOctet}(?:\.#{validateUrlDecOctet}){3})/i),twttr.txt.regexen.validateUrlIpv6=/(?:\[[a-f0-9:\.]+\])/i,twttr.txt.regexen.validateUrlIp=b("(?:#{validateUrlIpv4}|#{validateUrlIpv6})","i"),twttr.txt.regexen.validateUrlSubDomainSegment=/(?:[a-z0-9](?:[a-z0-9_\-]*[a-z0-9])?)/i,twttr.txt.regexen.validateUrlDomainSegment=/(?:[a-z0-9](?:[a-z0-9\-]*[a-z0-9])?)/i,twttr.txt.regexen.validateUrlDomainTld=/(?:[a-z](?:[a-z0-9\-]*[a-z0-9])?)/i,twttr.txt.regexen.validateUrlDomain=b(/(?:(?:#{validateUrlSubDomainSegment]}\.)*(?:#{validateUrlDomainSegment]}\.)#{validateUrlDomainTld})/i),twttr.txt.regexen.validateUrlHost=b("(?:#{validateUrlIp}|#{validateUrlDomain})","i"),twttr.txt.regexen.validateUrlUnicodeSubDomainSegment=/(?:(?:[a-z0-9]|[^\u0000-\u007f])(?:(?:[a-z0-9_\-]|[^\u0000-\u007f])*(?:[a-z0-9]|[^\u0000-\u007f]))?)/i,twttr.txt.regexen.validateUrlUnicodeDomainSegment=/(?:(?:[a-z0-9]|[^\u0000-\u007f])(?:(?:[a-z0-9\-]|[^\u0000-\u007f])*(?:[a-z0-9]|[^\u0000-\u007f]))?)/i,twttr.txt.regexen.validateUrlUnicodeDomainTld=/(?:(?:[a-z]|[^\u0000-\u007f])(?:(?:[a-z0-9\-]|[^\u0000-\u007f])*(?:[a-z0-9]|[^\u0000-\u007f]))?)/i,twttr.txt.regexen.validateUrlUnicodeDomain=b(/(?:(?:#{validateUrlUnicodeSubDomainSegment}\.)*(?:#{validateUrlUnicodeDomainSegment}\.)#{validateUrlUnicodeDomainTld})/i),twttr.txt.regexen.validateUrlUnicodeHost=b("(?:#{validateUrlIp}|#{validateUrlUnicodeDomain})","i"),twttr.txt.regexen.validateUrlPort=/[0-9]{1,5}/,twttr.txt.regexen.validateUrlUnicodeAuthority=b("(?:(#{validateUrlUserinfo})@)?(#{validateUrlUnicodeHost})(?::(#{validateUrlPort}))?","i"),twttr.txt.regexen.validateUrlAuthority=b("(?:(#{validateUrlUserinfo})@)?(#{validateUrlHost})(?::(#{validateUrlPort}))?","i"),twttr.txt.regexen.validateUrlPath=b(/(\/#{validateUrlPchar}*)*/i),twttr.txt.regexen.validateUrlQuery=b(/(#{validateUrlPchar}|\/|\?)*/i),twttr.txt.regexen.validateUrlFragment=b(/(#{validateUrlPchar}|\/|\?)*/i),twttr.txt.regexen.validateUrlUnencoded=b("^(?:([^:/?#]+):\\/\\/)?([^/?#]*)([^?#]*)(?:\\?([^#]*))?(?:#(.*))?$","i");var j="tweet-url",k="list-slug",l="username",m="hashtag",n=' rel="nofollow"';twttr.txt.autoLink=function(a,b){return b=o(b||{}),twttr.txt.autoLinkUsernamesOrLists(twttr.txt.autoLinkUrlsCustom(twttr.txt.autoLinkHashtags(a,b),b),b)},twttr.txt.autoLinkUsernamesOrLists=function(a,b){b=o(b||{}),b.urlClass=b.urlClass||j,b.listClass=b.listClass||k,b.usernameClass=b.usernameClass||l,b.usernameUrlBase=b.usernameUrlBase||"https://twitter.com/",b.listUrlBase=b.listUrlBase||"https://twitter.com/";if(!b.suppressNoFollow)var d=n;var e="",f=twttr.txt.splitTags(a);for(var g=0;g<f.length;g++){var h=f[g];g!==0&&(e+=g%2===0?">":"<"),g%4!==0?e+=h:e+=h.replace(twttr.txt.regexen.autoLinkUsernamesOrLists,function(a,e,f,g,h,i,j){var k=j.slice(i+a.length),l={before:e,at:b.usernameIncludeSymbol?"":f,at_before_user:b.usernameIncludeSymbol?f:"",user:twttr.txt.htmlEscape(g),slashListname:twttr.txt.htmlEscape(h),extraHtml:d,preChunk:"",postChunk:""};for(var m in b)b.hasOwnProperty(m)&&(l[m]=b[m]);if(h&&!b.suppressLists){var n=l.chunk=c("#{user}#{slashListname}",l);return l.list=twttr.txt.htmlEscape(n.toLowerCase()),c('#{before}#{at}<a class="#{urlClass} #{listClass}" href="#{listUrlBase}#{list}"#{extraHtml}>#{preChunk}#{at_before_user}#{chunk}#{postChunk}</a>',l)}return k&&k.match(twttr.txt.regexen.endScreenNameMatch)?a:(l.chunk=l.user,l.dataScreenName=b.suppressDataScreenName?"":c('data-screen-name="#{chunk}" ',l),c('#{before}#{at}<a class="#{urlClass} #{usernameClass}" #{dataScreenName}href="#{usernameUrlBase}#{chunk}"#{extraHtml}>#{preChunk}#{at_before_user}#{chunk}#{postChunk}</a>',l))})}return e},twttr.txt.autoLinkHashtags=function(a,b){b=o(b||{}),b.urlClass=b.urlClass||j,b.hashtagClass=b.hashtagClass||m,b.hashtagUrlBase=b.hashtagUrlBase||"https://twitter.com/#!/search?q=%23";if(!b.suppressNoFollow)var d=n;return a.replace(twttr.txt.regexen.autoLinkHashtags,function(a,e,f,g,h,i){var j=i.slice(h+a.length);if(j.match(twttr.txt.regexen.endHashtagMatch))return a;var k={before:e,hash:twttr.txt.htmlEscape(f),preText:"",text:twttr.txt.htmlEscape(g),postText:"",extraHtml:d};for(var l in b)b.hasOwnProperty(l)&&(k[l]=b[l]);return c('#{before}<a href="#{hashtagUrlBase}#{text}" title="##{text}" class="#{urlClass} #{hashtagClass}"#{extraHtml}>#{hash}#{preText}#{text}#{postText}</a>',k)})},twttr.txt.autoLinkUrlsCustom=function(a,b){b=o(b||{}),b.suppressNoFollow||(b.rel="nofollow"),b.urlClass&&(b["class"]=b.urlClass,delete b.urlClass);var d,e,f;if(b.urlEntities){d={};for(e=0,f=b.urlEntities.length;e<f;e++)d[b.urlEntities[e].url]=b.urlEntities[e]}return delete b.suppressNoFollow,delete b.suppressDataScreenName,delete b.listClass,delete b.usernameClass,delete b.usernameUrlBase,delete b.listUrlBase,delete b.urlEntities,a.replace(twttr.txt.regexen.extractUrl,function(a,e,f,g,h,i,j,k,l){var m;if(h){var n="",o="";g.match(twttr.txt.regexen.validTcoUrl)&&(g=RegExp.lastMatch,o=RegExp.rightContext);var p=g,q=twttr.txt.htmlEscape(p);if(d&&d[g]&&d[g].display_url){var p=d[g].display_url,r=d[g].expanded_url;b.title||(b.title=r);var s=p.replace(/…/g,"");if(r.indexOf(s)!=-1){var t=r.indexOf(s),u={displayUrlSansEllipses:s,beforeDisplayUrl:r.substr(0,t),afterDisplayUrl:r.substr(t+s.length),precedingEllipsis:p.match(/^…/)?"…":"",followingEllipsis:p.match(/…$/)?"…":""};$.each(u,function(a,b){u[a]=twttr.txt.htmlEscape(b)}),u.invisible="style='font-size:0; line-height:0'",q=c("<span class='tco-ellipsis'>#{precedingEllipsis}<span #{invisible}>&nbsp;</span></span><span #{invisible}>#{beforeDisplayUrl}</span><span class='js-display-url'>#{displayUrlSansEllipses}</span><span #{invisible}>#{afterDisplayUrl}</span><span class='tco-ellipsis'><span #{invisible}>&nbsp;</span>#{followingEllipsis}</span>",u)}}for(var v in b){var w=b[v].toString();n+=c(' #{k}="#{val}" ',{k:v,val:twttr.txt.htmlEscape(w)})}var x={before:f,htmlAttrs:n,url:twttr.txt.htmlEscape(g),linkText:q,after:o};return c('#{before}<a href="#{url}"#{htmlAttrs}>#{linkText}</a>#{after}',x)}return e})},twttr.txt.extractMentions=function(a){var b=[],c=twttr.txt.extractMentionsWithIndices(a);for(var d=0;d<c.length;d++){var e=c[d].screenName;b.push(e)}return b},twttr.txt.extractMentionsWithIndices=function(a){if(!a)return[];var b=[],c=0;return a.replace(twttr.txt.regexen.extractMentions,function(d,e,f,g,h,i){var j=i.slice(h+d.length);if(!j.match(twttr.txt.regexen.endScreenNameMatch)){var k=a.indexOf(f+g,c);c=k+g.length+1,b.push({screenName:g,indices:[k,c]})}}),b},twttr.txt.extractMentionsOrListsWithIndices=function(a){if(!a)return[];var b=[],c=0;return a.replace(twttr.txt.regexen.extractMentionsOrLists,function(d,e,f,g,h,i,j){var k=j.slice(i+d.length);if(!k.match(twttr.txt.regexen.endScreenNameMatch)){h=h||"";var l=a.indexOf(f+g+h,c);c=l+g.length+h.length+1,b.push({screenName:g,listSlug:h,indices:[l,c]})}}),b},twttr.txt.extractReplies=function(a){if(!a)return null;var b=a.match(twttr.txt.regexen.extractReply);return!b||RegExp.rightContext.match(twttr.txt.regexen.endScreenNameMatch)?null:b[1]},twttr.txt.extractUrls=function(a){var b=[],c=twttr.txt.extractUrlsWithIndices(a);for(var d=0;d<c.length;d++)b.push(c[d].url);return b},twttr.txt.extractUrlsWithIndices=function(a){if(!a)return[];var b=[];while(twttr.txt.regexen.extractUrl.exec(a)){var c=RegExp.$2,d=RegExp.$3,e=RegExp.$4,f=RegExp.$5,g=RegExp.$7,h=twttr.txt.regexen.extractUrl.lastIndex,i=h-d.length;if(!e){var j=null,k=!1,l=0;f.replace(twttr.txt.regexen.validAsciiDomain,function(a){var c=f.indexOf(a,l);l=c+a.length,j={url:a,indices:[i+c,i+l]},k=a.match(twttr.txt.regexen.invalidShortDomain),k||b.push(j)});if(j==null)continue;g&&(k&&b.push(j),j.url=d.replace(f,j.url),j.indices[1]=h)}else d.match(twttr.txt.regexen.validTcoUrl)&&(d=RegExp.lastMatch,h=i+d.length),b.push({url:d,indices:[i,h]})}return b},twttr.txt.extractHashtags=function(a){var b=[],c=twttr.txt.extractHashtagsWithIndices(a);for(var d=0;d<c.length;d++)b.push(c[d].hashtag);return b},twttr.txt.extractHashtagsWithIndices=function(a){if(!a)return[];var b=[],c=0;return a.replace(twttr.txt.regexen.autoLinkHashtags,function(d,e,f,g,h,i){var j=i.slice(h+d.length);if(j.match(twttr.txt.regexen.endHashtagMatch))return;var k=a.indexOf(f+g,c);c=k+g.length+1,b.push({hashtag:g,indices:[k,c]})}),b},twttr.txt.modifyIndicesFromUnicodeToUTF16=function(a,b){twttr.txt.convertUnicodeIndices(a,b,!1)},twttr.txt.modifyIndicesFromUTF16ToUnicode=function(a,b){twttr.txt.convertUnicodeIndices(a,b,!0)},twttr.txt.convertUnicodeIndices=function(a,b,c){if(b.length==0)return;var d=0,e=0;b.sort(function(a,b){return a.indices[0]-b.indices[0]});var f=0,g=b[0];while(d<a.length){if(g.indices[0]==(c?d:e)){var h=g.indices[1]-g.indices[0];g.indices[0]=c?e:d,g.indices[1]=g.indices[0]+h,f++;if(f==b.length)break;g=b[f]}var i=a.charCodeAt(d);55296<=i&&i<=56319&&d<a.length-1&&(i=a.charCodeAt(d+1),56320<=i&&i<=57343&&d++),e++,d++}},twttr.txt.splitTags=function(a){var b=a.split("<"),c,d=[],e;for(var f=0;f<b.length;f+=1){e=b[f];if(!e)d.push("");else{c=e.split(">");for(var g=0;g<c.length;g+=1)d.push(c[g])}}return d},twttr.txt.hitHighlight=function(a,b,c){var d="em";b=b||[],c=c||{};if(b.length===0)return a;var e=c.tag||d,f=["<"+e+">","</"+e+">"],g=twttr.txt.splitTags(a),h,i,j,k="",l=0,m=g[0],n=0,o=0,p=!1,q=m,r=[],s,t,u,v,w;for(i=0;i<b.length;i+=1)for(j=0;j<b[i].length;j+=1)r.push(b[i][j]);for(s=0;s<r.length;s+=1){t=r[s],u=f[s%2],v=!1;while(m!=null&&t>=n+m.length)k+=q.slice(o),p&&t===n+q.length&&(k+=u,v=!0),g[l+1]&&(k+="<"+g[l+1]+">"),n+=q.length,o=0,l+=2,m=g[l],q=m,p=!1;!v&&m!=null?(w=t-n,k+=q.slice(o,w)+u,o=w,s%2===0?p=!0:p=!1):v||(v=!0,k+=u)}if(m!=null){o<q.length&&(k+=q.slice(o));for(s=l+1;s<g.length;s+=1)k+=s%2===0?g[s]:"<"+g[s]+">"}return k};var p=140,q=[e(65534),e(65279),e(65535),e(8234),e(8235),e(8236),e(8237),e(8238)];twttr.txt.isInvalidTweet=function(a){if(!a)return"empty";if(a.length>p)return"too_long";for(var b=0;b<q.length;b++)if(a.indexOf(q[b])>=0)return"invalid_characters";return!1},twttr.txt.isValidTweetText=function(a){return!twttr.txt.isInvalidTweet(a)},twttr.txt.isValidUsername=function(a){if(!a)return!1;var b=twttr.txt.extractMentions(a);return b.length===1&&b[0]===a.slice(1)};var r=b(/^#{autoLinkUsernamesOrLists}$/);twttr.txt.isValidList=function(a){var b=a.match(r);return!!b&&b[1]==""&&!!b[4]},twttr.txt.isValidHashtag=function(a){if(!a)return!1;var b=twttr.txt.extractHashtags(a);return b.length===1&&b[0]===a.slice(1)},twttr.txt.isValidUrl=function(a,b,c){b==null&&(b=!0),c==null&&(c=!0);if(!a)return!1;var d=a.match(twttr.txt.regexen.validateUrlUnencoded);if(!d||d[0]!==a)return!1;var e=d[1],f=d[2],g=d[3],h=d[4],i=d[5];return(!c||s(e,twttr.txt.regexen.validateUrlScheme)&&e.match(/^https?$/i))&&s(g,twttr.txt.regexen.validateUrlPath)&&s(h,twttr.txt.regexen.validateUrlQuery,!0)&&s(i,twttr.txt.regexen.validateUrlFragment,!0)?b&&s(f,twttr.txt.regexen.validateUrlUnicodeAuthority)||!b&&s(f,twttr.txt.regexen.validateUrlAuthority):!1},typeof module!="undefined"&&module.exports&&(module.exports=twttr.txt)})();

//fgnass.github.com/spin.js#v1.2.4
(function(a,b,c){function g(a,c){var d=b.createElement(a||"div"),e;for(e in c)d[e]=c[e];return d}function h(a){for(var b=1,c=arguments.length;b<c;b++)a.appendChild(arguments[b]);return a}function j(a,b,c,d){var g=["opacity",b,~~(a*100),c,d].join("-"),h=.01+c/d*100,j=Math.max(1-(1-a)/b*(100-h),a),k=f.substring(0,f.indexOf("Animation")).toLowerCase(),l=k&&"-"+k+"-"||"";return e[g]||(i.insertRule("@"+l+"keyframes "+g+"{"+"0%{opacity:"+j+"}"+h+"%{opacity:"+a+"}"+(h+.01)+"%{opacity:1}"+(h+b)%100+"%{opacity:"+a+"}"+"100%{opacity:"+j+"}"+"}",0),e[g]=1),g}function k(a,b){var e=a.style,f,g;if(e[b]!==c)return b;b=b.charAt(0).toUpperCase()+b.slice(1);for(g=0;g<d.length;g++){f=d[g]+b;if(e[f]!==c)return f}}function l(a,b){for(var c in b)a.style[k(a,c)||c]=b[c];return a}function m(a){for(var b=1;b<arguments.length;b++){var d=arguments[b];for(var e in d)a[e]===c&&(a[e]=d[e])}return a}function n(a){var b={x:a.offsetLeft,y:a.offsetTop};while(a=a.offsetParent)b.x+=a.offsetLeft,b.y+=a.offsetTop;return b}var d=["webkit","Moz","ms","O"],e={},f,i=function(){var a=g("style");return h(b.getElementsByTagName("head")[0],a),a.sheet||a.styleSheet}(),o={lines:12,length:7,width:5,radius:10,color:"#000",speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"auto",left:"auto"},p=function q(a){if(!this.spin)return new q(a);this.opts=m(a||{},q.defaults,o)};p.defaults={},p.prototype={spin:function(a){this.stop();var b=this,c=b.opts,d=b.el=l(g(0,{className:c.className}),{position:"relative",zIndex:c.zIndex}),e=c.radius+c.length+c.width,h,i;a&&(a.insertBefore(d,a.firstChild||null),i=n(a),h=n(d),l(d,{left:(c.left=="auto"?i.x-h.x+(a.offsetWidth>>1):c.left+e)+"px",top:(c.top=="auto"?i.y-h.y+(a.offsetHeight>>1):c.top+e)+"px"})),d.setAttribute("aria-role","progressbar"),b.lines(d,b.opts);if(!f){var j=0,k=c.fps,m=k/c.speed,o=(1-c.opacity)/(m*c.trail/100),p=m/c.lines;!function q(){j++;for(var a=c.lines;a;a--){var e=Math.max(1-(j+a*p)%m*o,c.opacity);b.opacity(d,c.lines-a,e,c)}b.timeout=b.el&&setTimeout(q,~~(1e3/k))}()}return b},stop:function(){var a=this.el;return a&&(clearTimeout(this.timeout),a.parentNode&&a.parentNode.removeChild(a),this.el=c),this},lines:function(a,b){function e(a,d){return l(g(),{position:"absolute",width:b.length+b.width+"px",height:b.width+"px",background:a,boxShadow:d,transformOrigin:"left",transform:"rotate("+~~(360/b.lines*c)+"deg) translate("+b.radius+"px"+",0)",borderRadius:(b.width>>1)+"px"})}var c=0,d;for(;c<b.lines;c++)d=l(g(),{position:"absolute",top:1+~(b.width/2)+"px",transform:b.hwaccel?"translate3d(0,0,0)":"",opacity:b.opacity,animation:f&&j(b.opacity,b.trail,c,b.lines)+" "+1/b.speed+"s linear infinite"}),b.shadow&&h(d,l(e("#000","0 0 4px #000"),{top:"2px"})),h(a,h(d,e(b.color,"0 0 1px rgba(0,0,0,.1)")));return a},opacity:function(a,b,c){b<a.childNodes.length&&(a.childNodes[b].style.opacity=c)}},!function(){var a=l(g("group"),{behavior:"url(#default#VML)"}),b;if(!k(a,"transform")&&a.adj){for(b=4;b--;)i.addRule(["group","roundrect","fill","stroke"][b],"behavior:url(#default#VML)");p.prototype.lines=function(a,b){function e(){return l(g("group",{coordsize:d+" "+d,coordorigin:-c+" "+ -c}),{width:d,height:d})}function k(a,d,f){h(i,h(l(e(),{rotation:360/b.lines*a+"deg",left:~~d}),h(l(g("roundrect",{arcsize:1}),{width:c,height:b.width,left:b.radius,top:-b.width>>1,filter:f}),g("fill",{color:b.color,opacity:b.opacity}),g("stroke",{opacity:0}))))}var c=b.length+b.width,d=2*c,f=-(b.width+b.length)*2+"px",i=l(e(),{position:"absolute",top:f,left:f}),j;if(b.shadow)for(j=1;j<=b.lines;j++)k(j,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(j=1;j<=b.lines;j++)k(j);return h(a,i)},p.prototype.opacity=function(a,b,c,d){var e=a.firstChild;d=d.shadow&&d.lines||0,e&&b+d<e.childNodes.length&&(e=e.childNodes[b+d],e=e&&e.firstChild,e=e&&e.firstChild,e&&(e.opacity=c))}}else f=k(a,"animation")}(),a.Spinner=p})(window,document);
// Underscore.js 1.3.1
// (c) 2009-2012 Jeremy Ashkenas, DocumentCloud Inc.
// Underscore is freely distributable under the MIT license.
// Portions of Underscore are inspired or borrowed from Prototype,
// Oliver Steele's Functional, and John Resig's Micro-Templating.
// For all details and documentation:
// http://documentcloud.github.com/underscore
(function(){function q(a,c,d){if(a===c)return a!==0||1/a==1/c;if(a==null||c==null)return a===c;if(a._chain)a=a._wrapped;if(c._chain)c=c._wrapped;if(a.isEqual&&b.isFunction(a.isEqual))return a.isEqual(c);if(c.isEqual&&b.isFunction(c.isEqual))return c.isEqual(a);var e=l.call(a);if(e!=l.call(c))return false;switch(e){case "[object String]":return a==String(c);case "[object Number]":return a!=+a?c!=+c:a==0?1/a==1/c:a==+c;case "[object Date]":case "[object Boolean]":return+a==+c;case "[object RegExp]":return a.source==
c.source&&a.global==c.global&&a.multiline==c.multiline&&a.ignoreCase==c.ignoreCase}if(typeof a!="object"||typeof c!="object")return false;for(var f=d.length;f--;)if(d[f]==a)return true;d.push(a);var f=0,g=true;if(e=="[object Array]"){if(f=a.length,g=f==c.length)for(;f--;)if(!(g=f in a==f in c&&q(a[f],c[f],d)))break}else{if("constructor"in a!="constructor"in c||a.constructor!=c.constructor)return false;for(var h in a)if(b.has(a,h)&&(f++,!(g=b.has(c,h)&&q(a[h],c[h],d))))break;if(g){for(h in c)if(b.has(c,
h)&&!f--)break;g=!f}}d.pop();return g}var r=this,G=r._,n={},k=Array.prototype,o=Object.prototype,i=k.slice,H=k.unshift,l=o.toString,I=o.hasOwnProperty,w=k.forEach,x=k.map,y=k.reduce,z=k.reduceRight,A=k.filter,B=k.every,C=k.some,p=k.indexOf,D=k.lastIndexOf,o=Array.isArray,J=Object.keys,s=Function.prototype.bind,b=function(a){return new m(a)};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports)exports=module.exports=b;exports._=b}else r._=b;b.VERSION="1.3.1";var j=b.each=
b.forEach=function(a,c,d){if(a!=null)if(w&&a.forEach===w)a.forEach(c,d);else if(a.length===+a.length)for(var e=0,f=a.length;e<f;e++){if(e in a&&c.call(d,a[e],e,a)===n)break}else for(e in a)if(b.has(a,e)&&c.call(d,a[e],e,a)===n)break};b.map=b.collect=function(a,c,b){var e=[];if(a==null)return e;if(x&&a.map===x)return a.map(c,b);j(a,function(a,g,h){e[e.length]=c.call(b,a,g,h)});if(a.length===+a.length)e.length=a.length;return e};b.reduce=b.foldl=b.inject=function(a,c,d,e){var f=arguments.length>2;a==
null&&(a=[]);if(y&&a.reduce===y)return e&&(c=b.bind(c,e)),f?a.reduce(c,d):a.reduce(c);j(a,function(a,b,i){f?d=c.call(e,d,a,b,i):(d=a,f=true)});if(!f)throw new TypeError("Reduce of empty array with no initial value");return d};b.reduceRight=b.foldr=function(a,c,d,e){var f=arguments.length>2;a==null&&(a=[]);if(z&&a.reduceRight===z)return e&&(c=b.bind(c,e)),f?a.reduceRight(c,d):a.reduceRight(c);var g=b.toArray(a).reverse();e&&!f&&(c=b.bind(c,e));return f?b.reduce(g,c,d,e):b.reduce(g,c)};b.find=b.detect=
function(a,c,b){var e;E(a,function(a,g,h){if(c.call(b,a,g,h))return e=a,true});return e};b.filter=b.select=function(a,c,b){var e=[];if(a==null)return e;if(A&&a.filter===A)return a.filter(c,b);j(a,function(a,g,h){c.call(b,a,g,h)&&(e[e.length]=a)});return e};b.reject=function(a,c,b){var e=[];if(a==null)return e;j(a,function(a,g,h){c.call(b,a,g,h)||(e[e.length]=a)});return e};b.every=b.all=function(a,c,b){var e=true;if(a==null)return e;if(B&&a.every===B)return a.every(c,b);j(a,function(a,g,h){if(!(e=
e&&c.call(b,a,g,h)))return n});return e};var E=b.some=b.any=function(a,c,d){c||(c=b.identity);var e=false;if(a==null)return e;if(C&&a.some===C)return a.some(c,d);j(a,function(a,b,h){if(e||(e=c.call(d,a,b,h)))return n});return!!e};b.include=b.contains=function(a,c){var b=false;if(a==null)return b;return p&&a.indexOf===p?a.indexOf(c)!=-1:b=E(a,function(a){return a===c})};b.invoke=function(a,c){var d=i.call(arguments,2);return b.map(a,function(a){return(b.isFunction(c)?c||a:a[c]).apply(a,d)})};b.pluck=
function(a,c){return b.map(a,function(a){return a[c]})};b.max=function(a,c,d){if(!c&&b.isArray(a))return Math.max.apply(Math,a);if(!c&&b.isEmpty(a))return-Infinity;var e={computed:-Infinity};j(a,function(a,b,h){b=c?c.call(d,a,b,h):a;b>=e.computed&&(e={value:a,computed:b})});return e.value};b.min=function(a,c,d){if(!c&&b.isArray(a))return Math.min.apply(Math,a);if(!c&&b.isEmpty(a))return Infinity;var e={computed:Infinity};j(a,function(a,b,h){b=c?c.call(d,a,b,h):a;b<e.computed&&(e={value:a,computed:b})});
return e.value};b.shuffle=function(a){var b=[],d;j(a,function(a,f){f==0?b[0]=a:(d=Math.floor(Math.random()*(f+1)),b[f]=b[d],b[d]=a)});return b};b.sortBy=function(a,c,d){return b.pluck(b.map(a,function(a,b,g){return{value:a,criteria:c.call(d,a,b,g)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;return c<d?-1:c>d?1:0}),"value")};b.groupBy=function(a,c){var d={},e=b.isFunction(c)?c:function(a){return a[c]};j(a,function(a,b){var c=e(a,b);(d[c]||(d[c]=[])).push(a)});return d};b.sortedIndex=function(a,
c,d){d||(d=b.identity);for(var e=0,f=a.length;e<f;){var g=e+f>>1;d(a[g])<d(c)?e=g+1:f=g}return e};b.toArray=function(a){return!a?[]:a.toArray?a.toArray():b.isArray(a)?i.call(a):b.isArguments(a)?i.call(a):b.values(a)};b.size=function(a){return b.toArray(a).length};b.first=b.head=function(a,b,d){return b!=null&&!d?i.call(a,0,b):a[0]};b.initial=function(a,b,d){return i.call(a,0,a.length-(b==null||d?1:b))};b.last=function(a,b,d){return b!=null&&!d?i.call(a,Math.max(a.length-b,0)):a[a.length-1]};b.rest=
b.tail=function(a,b,d){return i.call(a,b==null||d?1:b)};b.compact=function(a){return b.filter(a,function(a){return!!a})};b.flatten=function(a,c){return b.reduce(a,function(a,e){if(b.isArray(e))return a.concat(c?e:b.flatten(e));a[a.length]=e;return a},[])};b.without=function(a){return b.difference(a,i.call(arguments,1))};b.uniq=b.unique=function(a,c,d){var d=d?b.map(a,d):a,e=[];b.reduce(d,function(d,g,h){if(0==h||(c===true?b.last(d)!=g:!b.include(d,g)))d[d.length]=g,e[e.length]=a[h];return d},[]);
return e};b.union=function(){return b.uniq(b.flatten(arguments,true))};b.intersection=b.intersect=function(a){var c=i.call(arguments,1);return b.filter(b.uniq(a),function(a){return b.every(c,function(c){return b.indexOf(c,a)>=0})})};b.difference=function(a){var c=b.flatten(i.call(arguments,1));return b.filter(a,function(a){return!b.include(c,a)})};b.zip=function(){for(var a=i.call(arguments),c=b.max(b.pluck(a,"length")),d=Array(c),e=0;e<c;e++)d[e]=b.pluck(a,""+e);return d};b.indexOf=function(a,c,
d){if(a==null)return-1;var e;if(d)return d=b.sortedIndex(a,c),a[d]===c?d:-1;if(p&&a.indexOf===p)return a.indexOf(c);for(d=0,e=a.length;d<e;d++)if(d in a&&a[d]===c)return d;return-1};b.lastIndexOf=function(a,b){if(a==null)return-1;if(D&&a.lastIndexOf===D)return a.lastIndexOf(b);for(var d=a.length;d--;)if(d in a&&a[d]===b)return d;return-1};b.range=function(a,b,d){arguments.length<=1&&(b=a||0,a=0);for(var d=arguments[2]||1,e=Math.max(Math.ceil((b-a)/d),0),f=0,g=Array(e);f<e;)g[f++]=a,a+=d;return g};
var F=function(){};b.bind=function(a,c){var d,e;if(a.bind===s&&s)return s.apply(a,i.call(arguments,1));if(!b.isFunction(a))throw new TypeError;e=i.call(arguments,2);return d=function(){if(!(this instanceof d))return a.apply(c,e.concat(i.call(arguments)));F.prototype=a.prototype;var b=new F,g=a.apply(b,e.concat(i.call(arguments)));return Object(g)===g?g:b}};b.bindAll=function(a){var c=i.call(arguments,1);c.length==0&&(c=b.functions(a));j(c,function(c){a[c]=b.bind(a[c],a)});return a};b.memoize=function(a,
c){var d={};c||(c=b.identity);return function(){var e=c.apply(this,arguments);return b.has(d,e)?d[e]:d[e]=a.apply(this,arguments)}};b.delay=function(a,b){var d=i.call(arguments,2);return setTimeout(function(){return a.apply(a,d)},b)};b.defer=function(a){return b.delay.apply(b,[a,1].concat(i.call(arguments,1)))};b.throttle=function(a,c){var d,e,f,g,h,i=b.debounce(function(){h=g=false},c);return function(){d=this;e=arguments;var b;f||(f=setTimeout(function(){f=null;h&&a.apply(d,e);i()},c));g?h=true:
a.apply(d,e);i();g=true}};b.debounce=function(a,b){var d;return function(){var e=this,f=arguments;clearTimeout(d);d=setTimeout(function(){d=null;a.apply(e,f)},b)}};b.once=function(a){var b=false,d;return function(){if(b)return d;b=true;return d=a.apply(this,arguments)}};b.wrap=function(a,b){return function(){var d=[a].concat(i.call(arguments,0));return b.apply(this,d)}};b.compose=function(){var a=arguments;return function(){for(var b=arguments,d=a.length-1;d>=0;d--)b=[a[d].apply(this,b)];return b[0]}};
b.after=function(a,b){return a<=0?b():function(){if(--a<1)return b.apply(this,arguments)}};b.keys=J||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var c=[],d;for(d in a)b.has(a,d)&&(c[c.length]=d);return c};b.values=function(a){return b.map(a,b.identity)};b.functions=b.methods=function(a){var c=[],d;for(d in a)b.isFunction(a[d])&&c.push(d);return c.sort()};b.extend=function(a){j(i.call(arguments,1),function(b){for(var d in b)a[d]=b[d]});return a};b.defaults=function(a){j(i.call(arguments,
1),function(b){for(var d in b)a[d]==null&&(a[d]=b[d])});return a};b.clone=function(a){return!b.isObject(a)?a:b.isArray(a)?a.slice():b.extend({},a)};b.tap=function(a,b){b(a);return a};b.isEqual=function(a,b){return q(a,b,[])};b.isEmpty=function(a){if(b.isArray(a)||b.isString(a))return a.length===0;for(var c in a)if(b.has(a,c))return false;return true};b.isElement=function(a){return!!(a&&a.nodeType==1)};b.isArray=o||function(a){return l.call(a)=="[object Array]"};b.isObject=function(a){return a===Object(a)};
b.isArguments=function(a){return l.call(a)=="[object Arguments]"};if(!b.isArguments(arguments))b.isArguments=function(a){return!(!a||!b.has(a,"callee"))};b.isFunction=function(a){return l.call(a)=="[object Function]"};b.isString=function(a){return l.call(a)=="[object String]"};b.isNumber=function(a){return l.call(a)=="[object Number]"};b.isNaN=function(a){return a!==a};b.isBoolean=function(a){return a===true||a===false||l.call(a)=="[object Boolean]"};b.isDate=function(a){return l.call(a)=="[object Date]"};
b.isRegExp=function(a){return l.call(a)=="[object RegExp]"};b.isNull=function(a){return a===null};b.isUndefined=function(a){return a===void 0};b.has=function(a,b){return I.call(a,b)};b.noConflict=function(){r._=G;return this};b.identity=function(a){return a};b.times=function(a,b,d){for(var e=0;e<a;e++)b.call(d,e)};b.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};b.mixin=function(a){j(b.functions(a),
function(c){K(c,b[c]=a[c])})};var L=0;b.uniqueId=function(a){var b=L++;return a?a+b:b};b.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var t=/.^/,u=function(a){return a.replace(/\\\\/g,"\\").replace(/\\'/g,"'")};b.template=function(a,c){var d=b.templateSettings,d="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+a.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(d.escape||t,function(a,b){return"',_.escape("+
u(b)+"),'"}).replace(d.interpolate||t,function(a,b){return"',"+u(b)+",'"}).replace(d.evaluate||t,function(a,b){return"');"+u(b).replace(/[\r\n\t]/g," ")+";__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",e=new Function("obj","_",d);return c?e(c,b):function(a){return e.call(this,a,b)}};b.chain=function(a){return b(a).chain()};var m=function(a){this._wrapped=a};b.prototype=m.prototype;var v=function(a,c){return c?b(a).chain():a},K=function(a,c){m.prototype[a]=
function(){var a=i.call(arguments);H.call(a,this._wrapped);return v(c.apply(b,a),this._chain)}};b.mixin(b);j("pop,push,reverse,shift,sort,splice,unshift".split(","),function(a){var b=k[a];m.prototype[a]=function(){var d=this._wrapped;b.apply(d,arguments);var e=d.length;(a=="shift"||a=="splice")&&e===0&&delete d[0];return v(d,this._chain)}});j(["concat","join","slice"],function(a){var b=k[a];m.prototype[a]=function(){return v(b.apply(this._wrapped,arguments),this._chain)}});m.prototype.chain=function(){this._chain=
true;return this};m.prototype.value=function(){return this._wrapped}}).call(this);

// Backbone.js 0.9.1

// (c) 2010-2012 Jeremy Ashkenas, DocumentCloud Inc.
// Backbone may be freely distributed under the MIT license.
// For all details and documentation:
// http://backbonejs.org
(function(){var i=this,r=i.Backbone,s=Array.prototype.slice,t=Array.prototype.splice,g;g="undefined"!==typeof exports?exports:i.Backbone={};g.VERSION="0.9.1";var f=i._;!f&&"undefined"!==typeof require&&(f=require("underscore"));var h=i.jQuery||i.Zepto||i.ender;g.setDomLibrary=function(a){h=a};g.noConflict=function(){i.Backbone=r;return this};g.emulateHTTP=!1;g.emulateJSON=!1;g.Events={on:function(a,b,c){for(var d,a=a.split(/\s+/),e=this._callbacks||(this._callbacks={});d=a.shift();){d=e[d]||(e[d]=
{});var f=d.tail||(d.tail=d.next={});f.callback=b;f.context=c;d.tail=f.next={}}return this},off:function(a,b,c){var d,e,f;if(a){if(e=this._callbacks)for(a=a.split(/\s+/);d=a.shift();)if(f=e[d],delete e[d],b&&f)for(;(f=f.next)&&f.next;)if(!(f.callback===b&&(!c||f.context===c)))this.on(d,f.callback,f.context)}else delete this._callbacks;return this},trigger:function(a){var b,c,d,e;if(!(d=this._callbacks))return this;e=d.all;for((a=a.split(/\s+/)).push(null);b=a.shift();)e&&a.push({next:e.next,tail:e.tail,
event:b}),(c=d[b])&&a.push({next:c.next,tail:c.tail});for(e=s.call(arguments,1);c=a.pop();){b=c.tail;for(d=c.event?[c.event].concat(e):e;(c=c.next)!==b;)c.callback.apply(c.context||this,d)}return this}};g.Events.bind=g.Events.on;g.Events.unbind=g.Events.off;g.Model=function(a,b){var c;a||(a={});b&&b.parse&&(a=this.parse(a));if(c=j(this,"defaults"))a=f.extend({},c,a);b&&b.collection&&(this.collection=b.collection);this.attributes={};this._escapedAttributes={};this.cid=f.uniqueId("c");if(!this.set(a,
{silent:!0}))throw Error("Can't create an invalid model");delete this._changed;this._previousAttributes=f.clone(this.attributes);this.initialize.apply(this,arguments)};f.extend(g.Model.prototype,g.Events,{idAttribute:"id",initialize:function(){},toJSON:function(){return f.clone(this.attributes)},get:function(a){return this.attributes[a]},escape:function(a){var b;if(b=this._escapedAttributes[a])return b;b=this.attributes[a];return this._escapedAttributes[a]=f.escape(null==b?"":""+b)},has:function(a){return null!=
this.attributes[a]},set:function(a,b,c){var d,e;f.isObject(a)||null==a?(d=a,c=b):(d={},d[a]=b);c||(c={});if(!d)return this;d instanceof g.Model&&(d=d.attributes);if(c.unset)for(e in d)d[e]=void 0;if(!this._validate(d,c))return!1;this.idAttribute in d&&(this.id=d[this.idAttribute]);var b=this.attributes,k=this._escapedAttributes,n=this._previousAttributes||{},h=this._setting;this._changed||(this._changed={});this._setting=!0;for(e in d)if(a=d[e],f.isEqual(b[e],a)||delete k[e],c.unset?delete b[e]:b[e]=
a,this._changing&&!f.isEqual(this._changed[e],a)&&(this.trigger("change:"+e,this,a,c),this._moreChanges=!0),delete this._changed[e],!f.isEqual(n[e],a)||f.has(b,e)!=f.has(n,e))this._changed[e]=a;h||(!c.silent&&this.hasChanged()&&this.change(c),this._setting=!1);return this},unset:function(a,b){(b||(b={})).unset=!0;return this.set(a,null,b)},clear:function(a){(a||(a={})).unset=!0;return this.set(f.clone(this.attributes),a)},fetch:function(a){var a=a?f.clone(a):{},b=this,c=a.success;a.success=function(d,
e,f){if(!b.set(b.parse(d,f),a))return!1;c&&c(b,d)};a.error=g.wrapError(a.error,b,a);return(this.sync||g.sync).call(this,"read",this,a)},save:function(a,b,c){var d,e;f.isObject(a)||null==a?(d=a,c=b):(d={},d[a]=b);c=c?f.clone(c):{};c.wait&&(e=f.clone(this.attributes));a=f.extend({},c,{silent:!0});if(d&&!this.set(d,c.wait?a:c))return!1;var k=this,h=c.success;c.success=function(a,b,e){b=k.parse(a,e);c.wait&&(b=f.extend(d||{},b));if(!k.set(b,c))return!1;h?h(k,a):k.trigger("sync",k,a,c)};c.error=g.wrapError(c.error,
k,c);b=this.isNew()?"create":"update";b=(this.sync||g.sync).call(this,b,this,c);c.wait&&this.set(e,a);return b},destroy:function(a){var a=a?f.clone(a):{},b=this,c=a.success,d=function(){b.trigger("destroy",b,b.collection,a)};if(this.isNew())return d();a.success=function(e){a.wait&&d();c?c(b,e):b.trigger("sync",b,e,a)};a.error=g.wrapError(a.error,b,a);var e=(this.sync||g.sync).call(this,"delete",this,a);a.wait||d();return e},url:function(){var a=j(this.collection,"url")||j(this,"urlRoot")||o();return this.isNew()?
a:a+("/"==a.charAt(a.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(a){return a},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},change:function(a){if(this._changing||!this.hasChanged())return this;this._moreChanges=this._changing=!0;for(var b in this._changed)this.trigger("change:"+b,this,this._changed[b],a);for(;this._moreChanges;)this._moreChanges=!1,this.trigger("change",this,a);this._previousAttributes=f.clone(this.attributes);
delete this._changed;this._changing=!1;return this},hasChanged:function(a){return!arguments.length?!f.isEmpty(this._changed):this._changed&&f.has(this._changed,a)},changedAttributes:function(a){if(!a)return this.hasChanged()?f.clone(this._changed):!1;var b,c=!1,d=this._previousAttributes,e;for(e in a)if(!f.isEqual(d[e],b=a[e]))(c||(c={}))[e]=b;return c},previous:function(a){return!arguments.length||!this._previousAttributes?null:this._previousAttributes[a]},previousAttributes:function(){return f.clone(this._previousAttributes)},
isValid:function(){return!this.validate(this.attributes)},_validate:function(a,b){if(b.silent||!this.validate)return!0;var a=f.extend({},this.attributes,a),c=this.validate(a,b);if(!c)return!0;b&&b.error?b.error(this,c,b):this.trigger("error",this,c,b);return!1}});g.Collection=function(a,b){b||(b={});b.comparator&&(this.comparator=b.comparator);this._reset();this.initialize.apply(this,arguments);a&&this.reset(a,{silent:!0,parse:b.parse})};f.extend(g.Collection.prototype,g.Events,{model:g.Model,initialize:function(){},
toJSON:function(){return this.map(function(a){return a.toJSON()})},add:function(a,b){var c,d,e,g,h,i={},j={};b||(b={});a=f.isArray(a)?a.slice():[a];for(c=0,d=a.length;c<d;c++){if(!(e=a[c]=this._prepareModel(a[c],b)))throw Error("Can't add an invalid model to a collection");if(i[g=e.cid]||this._byCid[g]||null!=(h=e.id)&&(j[h]||this._byId[h]))throw Error("Can't add the same model to a collection twice");i[g]=j[h]=e}for(c=0;c<d;c++)(e=a[c]).on("all",this._onModelEvent,this),this._byCid[e.cid]=e,null!=
e.id&&(this._byId[e.id]=e);this.length+=d;t.apply(this.models,[null!=b.at?b.at:this.models.length,0].concat(a));this.comparator&&this.sort({silent:!0});if(b.silent)return this;for(c=0,d=this.models.length;c<d;c++)if(i[(e=this.models[c]).cid])b.index=c,e.trigger("add",e,this,b);return this},remove:function(a,b){var c,d,e,g;b||(b={});a=f.isArray(a)?a.slice():[a];for(c=0,d=a.length;c<d;c++)if(g=this.getByCid(a[c])||this.get(a[c]))delete this._byId[g.id],delete this._byCid[g.cid],e=this.indexOf(g),this.models.splice(e,
1),this.length--,b.silent||(b.index=e,g.trigger("remove",g,this,b)),this._removeReference(g);return this},get:function(a){return null==a?null:this._byId[null!=a.id?a.id:a]},getByCid:function(a){return a&&this._byCid[a.cid||a]},at:function(a){return this.models[a]},sort:function(a){a||(a={});if(!this.comparator)throw Error("Cannot sort a set without a comparator");var b=f.bind(this.comparator,this);1==this.comparator.length?this.models=this.sortBy(b):this.models.sort(b);a.silent||this.trigger("reset",
this,a);return this},pluck:function(a){return f.map(this.models,function(b){return b.get(a)})},reset:function(a,b){a||(a=[]);b||(b={});for(var c=0,d=this.models.length;c<d;c++)this._removeReference(this.models[c]);this._reset();this.add(a,{silent:!0,parse:b.parse});b.silent||this.trigger("reset",this,b);return this},fetch:function(a){a=a?f.clone(a):{};void 0===a.parse&&(a.parse=!0);var b=this,c=a.success;a.success=function(d,e,f){b[a.add?"add":"reset"](b.parse(d,f),a);c&&c(b,d)};a.error=g.wrapError(a.error,
b,a);return(this.sync||g.sync).call(this,"read",this,a)},create:function(a,b){var c=this,b=b?f.clone(b):{},a=this._prepareModel(a,b);if(!a)return!1;b.wait||c.add(a,b);var d=b.success;b.success=function(e,f){b.wait&&c.add(e,b);d?d(e,f):e.trigger("sync",a,f,b)};a.save(null,b);return a},parse:function(a){return a},chain:function(){return f(this.models).chain()},_reset:function(){this.length=0;this.models=[];this._byId={};this._byCid={}},_prepareModel:function(a,b){a instanceof g.Model?a.collection||
(a.collection=this):(b.collection=this,a=new this.model(a,b),a._validate(a.attributes,b)||(a=!1));return a},_removeReference:function(a){this==a.collection&&delete a.collection;a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,b,c,d){("add"==a||"remove"==a)&&c!=this||("destroy"==a&&this.remove(b,d),b&&a==="change:"+b.idAttribute&&(delete this._byId[b.previous(b.idAttribute)],this._byId[b.id]=b),this.trigger.apply(this,arguments))}});f.each("forEach,each,map,reduce,reduceRight,find,detect,filter,select,reject,every,all,some,any,include,contains,invoke,max,min,sortBy,sortedIndex,toArray,size,first,initial,rest,last,without,indexOf,shuffle,lastIndexOf,isEmpty,groupBy".split(","),
function(a){g.Collection.prototype[a]=function(){return f[a].apply(f,[this.models].concat(f.toArray(arguments)))}});g.Router=function(a){a||(a={});a.routes&&(this.routes=a.routes);this._bindRoutes();this.initialize.apply(this,arguments)};var u=/:\w+/g,v=/\*\w+/g,w=/[-[\]{}()+?.,\\^$|#\s]/g;f.extend(g.Router.prototype,g.Events,{initialize:function(){},route:function(a,b,c){g.history||(g.history=new g.History);f.isRegExp(a)||(a=this._routeToRegExp(a));c||(c=this[b]);g.history.route(a,f.bind(function(d){d=
this._extractParameters(a,d);c&&c.apply(this,d);this.trigger.apply(this,["route:"+b].concat(d));g.history.trigger("route",this,b,d)},this));return this},navigate:function(a,b){g.history.navigate(a,b)},_bindRoutes:function(){if(this.routes){var a=[],b;for(b in this.routes)a.unshift([b,this.routes[b]]);b=0;for(var c=a.length;b<c;b++)this.route(a[b][0],a[b][1],this[a[b][1]])}},_routeToRegExp:function(a){a=a.replace(w,"\\$&").replace(u,"([^/]+)").replace(v,"(.*?)");return RegExp("^"+a+"$")},_extractParameters:function(a,
b){return a.exec(b).slice(1)}});g.History=function(){this.handlers=[];f.bindAll(this,"checkUrl")};var m=/^[#\/]/,x=/msie [\w.]+/,l=!1;f.extend(g.History.prototype,g.Events,{interval:50,getFragment:function(a,b){if(null==a)if(this._hasPushState||b){var a=window.location.pathname,c=window.location.search;c&&(a+=c)}else a=window.location.hash;a=decodeURIComponent(a);a.indexOf(this.options.root)||(a=a.substr(this.options.root.length));return a.replace(m,"")},start:function(a){if(l)throw Error("Backbone.history has already been started");
this.options=f.extend({},{root:"/"},this.options,a);this._wantsHashChange=!1!==this.options.hashChange;this._wantsPushState=!!this.options.pushState;this._hasPushState=!(!this.options.pushState||!window.history||!window.history.pushState);var a=this.getFragment(),b=document.documentMode;if(b=x.exec(navigator.userAgent.toLowerCase())&&(!b||7>=b))this.iframe=h('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(a);this._hasPushState?h(window).bind("popstate",
this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!b?h(window).bind("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval));this.fragment=a;l=!0;a=window.location;b=a.pathname==this.options.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!b)return this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&b&&a.hash&&
(this.fragment=a.hash.replace(m,""),window.history.replaceState({},document.title,a.protocol+"//"+a.host+this.options.root+this.fragment));if(!this.options.silent)return this.loadUrl()},stop:function(){h(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl);clearInterval(this._checkUrlInterval);l=!1},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(){var a=this.getFragment();a==this.fragment&&this.iframe&&(a=this.getFragment(this.iframe.location.hash));
if(a==this.fragment||a==decodeURIComponent(this.fragment))return!1;this.iframe&&this.navigate(a);this.loadUrl()||this.loadUrl(window.location.hash)},loadUrl:function(a){var b=this.fragment=this.getFragment(a);return f.any(this.handlers,function(a){if(a.route.test(b))return a.callback(b),!0})},navigate:function(a,b){if(!l)return!1;if(!b||!0===b)b={trigger:b};var c=(a||"").replace(m,"");this.fragment==c||this.fragment==decodeURIComponent(c)||(this._hasPushState?(0!=c.indexOf(this.options.root)&&(c=
this.options.root+c),this.fragment=c,window.history[b.replace?"replaceState":"pushState"]({},document.title,c)):this._wantsHashChange?(this.fragment=c,this._updateHash(window.location,c,b.replace),this.iframe&&c!=this.getFragment(this.iframe.location.hash)&&(b.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,c,b.replace))):window.location.assign(this.options.root+a),b.trigger&&this.loadUrl(a))},_updateHash:function(a,b,c){c?a.replace(a.toString().replace(/(javascript:|#).*$/,
"")+"#"+b):a.hash=b}});g.View=function(a){this.cid=f.uniqueId("view");this._configure(a||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()};var y=/^(\S+)\s*(.*)$/,p="model,collection,el,id,attributes,className,tagName".split(",");f.extend(g.View.prototype,g.Events,{tagName:"div",$:function(a){return this.$el.find(a)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();return this},make:function(a,b,c){a=document.createElement(a);
b&&h(a).attr(b);c&&h(a).html(c);return a},setElement:function(a,b){this.$el=h(a);this.el=this.$el[0];!1!==b&&this.delegateEvents();return this},delegateEvents:function(a){if(a||(a=j(this,"events"))){this.undelegateEvents();for(var b in a){var c=a[b];f.isFunction(c)||(c=this[a[b]]);if(!c)throw Error('Event "'+a[b]+'" does not exist');var d=b.match(y),e=d[1],d=d[2],c=f.bind(c,this),e=e+(".delegateEvents"+this.cid);""===d?this.$el.bind(e,c):this.$el.delegate(d,e,c)}}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+
this.cid)},_configure:function(a){this.options&&(a=f.extend({},this.options,a));for(var b=0,c=p.length;b<c;b++){var d=p[b];a[d]&&(this[d]=a[d])}this.options=a},_ensureElement:function(){if(this.el)this.setElement(this.el,!1);else{var a=j(this,"attributes")||{};this.id&&(a.id=this.id);this.className&&(a["class"]=this.className);this.setElement(this.make(this.tagName,a),!1)}}});g.Model.extend=g.Collection.extend=g.Router.extend=g.View.extend=function(a,b){var c=z(this,a,b);c.extend=this.extend;return c};
var A={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};g.sync=function(a,b,c){var d=A[a],e={type:d,dataType:"json"};c.url||(e.url=j(b,"url")||o());if(!c.data&&b&&("create"==a||"update"==a))e.contentType="application/json",e.data=JSON.stringify(b.toJSON());g.emulateJSON&&(e.contentType="application/x-www-form-urlencoded",e.data=e.data?{model:e.data}:{});if(g.emulateHTTP&&("PUT"===d||"DELETE"===d))g.emulateJSON&&(e.data._method=d),e.type="POST",e.beforeSend=function(a){a.setRequestHeader("X-HTTP-Method-Override",
d)};"GET"!==e.type&&!g.emulateJSON&&(e.processData=!1);return h.ajax(f.extend(e,c))};g.wrapError=function(a,b,c){return function(d,e){e=d===b?e:d;a?a(b,e,c):b.trigger("error",b,e,c)}};var q=function(){},z=function(a,b,c){var d;d=b&&b.hasOwnProperty("constructor")?b.constructor:function(){a.apply(this,arguments)};f.extend(d,a);q.prototype=a.prototype;d.prototype=new q;b&&f.extend(d.prototype,b);c&&f.extend(d,c);d.prototype.constructor=d;d.__super__=a.prototype;return d},j=function(a,b){return!a||!a[b]?
null:f.isFunction(a[b])?a[b]():a[b]},o=function(){throw Error('A "url" property or function must be specified');}}).call(this);

/**
 * Backbone localStorage Adapter v1.0
 * https://github.com/jeromegn/Backbone.localStorage
 */
function S4(){return((1+Math.random())*65536|0).toString(16).substring(1)}function guid(){return S4()+S4()+"-"+S4()+"-"+S4()+"-"+S4()+"-"+S4()+S4()+S4()}window.Store=function(a){this.name=a;var b=localStorage.getItem(this.name);this.records=b&&b.split(",")||[]},_.extend(Store.prototype,{save:function(){localStorage.setItem(this.name,this.records.join(","))},create:function(a){return a.id||(a.id=a.attributes.id=guid()),localStorage.setItem(this.name+"-"+a.id,JSON.stringify(a)),this.records.push(a.id.toString()),this.save(),a},update:function(a){return localStorage.setItem(this.name+"-"+a.id,JSON.stringify(a)),_.include(this.records,a.id.toString())||this.records.push(a.id.toString()),this.save(),a},find:function(a){return JSON.parse(localStorage.getItem(this.name+"-"+a.id))},findAll:function(){return _.map(this.records,function(a){return JSON.parse(localStorage.getItem(this.name+"-"+a))},this)},destroy:function(a){return localStorage.removeItem(this.name+"-"+a.id),this.records=_.reject(this.records,function(b){return b==a.id.toString()}),this.save(),a}}),Backbone.localSync=function(a,b,c,d){typeof c=="function"&&(c={success:c,error:d});var e,f=b.localStorage||b.collection.localStorage;switch(a){case"read":e=b.id!=undefined?f.find(b):f.findAll();break;case"create":e=f.create(b);break;case"update":e=f.update(b);break;case"delete":e=f.destroy(b)}e?c.success(e):c.error("Record not found")},Backbone.ajaxSync=Backbone.sync,Backbone.sync=Backbone.localSync;
/* jQuery.TmplDeck | author: Takeshi Takatsudo / repo: https://github.com/Takazudo/jQuery.TmplDeck */
(function(a,b,c,d,e){d.TmplDeck=function(b,c){if(this instanceof arguments.callee)this._options=a.extend({},this._options,c,{url:b}),this._fetchDefer=a.Deferred(),this._cache={};else return new d.TmplDeck(b,c)},d.TmplDeck.prototype={_options:{dataType:"text",url:null,cache:!0},_fetchedText:null,_fetchDefer:null,_cache:null,load:function(){var b=this;return a.ajax(b._options).then(function(a){b._fetchedText=a,b._fetchDefer.resolve()},function(){alert("ajax failed")})},ready:function(a){this._fetchDefer.done(function(){a()})},draw:function(a){if(this._cache[a])ret=this._cache[a];else{var b=new RegExp("(^|\\n)"+a+"\\s{{{\\r?\\n([\\s\\S]+?)}}}"),c=this._fetchedText.match(b);ret=c?this._cache[a]=c[2]:null}return ret}},d.TmplDeck.prototype.tmpl=function(a,b){return _.template(this.draw(a))(b)}})(jQuery,this,this.document,jQuery);

/*! jQuery.ImgLoader - v0.1.0 -  2/26/2012
 * https://github.com/Takazudo/jQuery.ImgLoader
 * Copyright (c) 2012 "Takazudo" Takeshi Takatsudo; Licensed MIT */
(function(){var a,b,c=Array.prototype.slice,d=Object.prototype.hasOwnProperty,e=function(a,b){function e(){this.constructor=a}for(var c in b)d.call(b,c)&&(a[c]=b[c]);return e.prototype=b.prototype,a.prototype=new e,a.__super__=b.prototype,a};a=$.ImgLoaderNs={},a.createCachedFunction=function(a){var b;return b={},function(c){return b[c]||(b[c]=$.Deferred(function(b){return a(b,c)}).promise()),b[c]}},a.fetchImg=a.createCachedFunction(function(a,b){var c,d,e;return e=new Image,d=function(){return e.onload=e.onerror=null},a.always(d),c=$(e),e.onload=function(){return a.resolve(c)},e.onerror=function(){return a.reject(c)},e.src=b}),function(){var b;return b={},a.loadImg=function(c){return $.Deferred(function(d){return a.fetchImg(c).then(function(a){var e,f;return b[c]||(b[c]=a),e=b[c],f=e.clone(),b[c]=f,d.resolve(e)},function(a){return d.reject(a)})}).promise()}}(),b=function(a){return $.Deferred(function(b){return setTimeout(function(){return b.resolve()},a)})},a.Event=function(){function a(){this._callbacks={}}return a.prototype.bind=function(a,b){var c,d,e,f,g;c=a.split(" ");for(f=0,g=c.length;f<g;f++)d=c[f],(e=this._callbacks)[d]||(e[d]=[]),this._callbacks[d].push(b);return this},a.prototype.one=function(a,b){return this.bind(a,function(){return this.unbind(a,arguments.callee),b.apply(this,arguments)})},a.prototype.trigger=function(){var a,b,d,e,f,g,h;a=1<=arguments.length?c.call(arguments,0):[],d=a.shift(),e=(h=this._callbacks)!=null?h[d]:void 0;if(!e)return;for(f=0,g=e.length;f<g;f++){b=e[f];if(b.apply(this,a)===!1)break}return this},a.prototype.unbind=function(a,b){var c,d,e,f,g;if(!a)return this._callbacks={},this;e=(g=this._callbacks)!=null?g[a]:void 0;if(!e)return this;if(!b)return delete this._callbacks[a],this;for(d=0,f=e.length;d<f;d++){c=e[d];if(c!==b)continue;e=e.slice(),e.splice(d,1),this._callbacks[a]=e;break}return this},a}(),a.LoaderItem=function(b){function c(a){this.src=a,c.__super__.constructor.apply(this,arguments)}return e(c,b),c.prototype.load=function(){var b=this;return $.Deferred(function(c){return a.loadImg(b.src).pipe(function(a){return b.$img=a,b.trigger("success",b.$img),b.trigger("complete",b.$img),c.resolve(b.$img)},function(a){return b.$img=a,b.trigger("error",b.$img),b.trigger("complete",b.$img),c.reject(b.$img)})}).promise()},c}(a.Event),a.BasicLoader=function(b){function d(){d.__super__.constructor.apply(this,arguments),this.items=[]}return e(d,b),d.prototype.add=function(b){var c;return $.type(b)==="string"&&(c=b,b=new a.LoaderItem(c)),this.items.push(b),b},d.prototype.load=function(){var a,b,d=this;return a=0,b=$.map(this.items,function(b){return b.bind("complete",function(b){return d.trigger("itemload",b,a),a++}).load()}),$.Deferred(function(a){return $.when.apply(d,b).always(function(){var b,e;return e=1<=arguments.length?c.call(arguments,0):[],b=$(e),d.trigger("allload",b),a.resolve(b)})})},d.prototype.kill=function(){return $.each(this.items,function(a,b){return b.unbind()}),this.trigger("kill"),this.unbind(),this},d}(a.Event),a.ChainLoader=function(b){function c(a,b){this._pipesize=a,this._delay=b!=null?b:0,c.__super__.constructor.apply(this,arguments),this._presets=[],this._doneCount=0,this._inLoadCount=0,this._allDoneDefer=$.Deferred()}return e(c,b),c.prototype._finished=function(){return this._doneCount===this._presets.length},c.prototype._nextLoadAllowed=function(){return this._inLoadCount<this._pipesize},c.prototype._getImgs=function(){return $($.map(this._presets,function(a){return a.item.$img}))},c.prototype._handleNext=function(){var a,b=this;return this._finished()?this._allloadFired?this:(this._allloadFired=!0,a=this._getImgs(),this.trigger("allload",a),this._allDoneDefer.resolve(a),this):($.each(this._presets,function(a,c){return c.started?!0:b._nextLoadAllowed()?(b._inLoadCount++,c.started=!0,c.item.one("complete",function(d){return c.done=!0,setTimeout(function(){var e;return e=function(){return b.trigger("itemload",d,b._doneCount),b._inLoadCount--,b._doneCount++,c.defer.resolve(d),b._handleNext()},a===0?e():b._presets[a-1].defer.always(function(){return e()})},b._delay)}),c.item.load()):!1}),this)},c.prototype.add=function(b){var c,d;return $.type(b)==="string"&&(d=b,b=new a.LoaderItem(d)),c={item:b,done:!1,started:!1,defer:$.Deferred()},this._presets.push(c),c.defer},c.prototype.load=function(){return this._handleNext(),this._allDoneDefer},c.prototype.kill=function(){return $.each(this._presets,function(a,b){return b.item.unbind()}),this.trigger("kill"),this.unbind(),this},c}(a.Event),a.LoaderFacade=function(){function e(b){var c,d=this;if(this instanceof arguments.callee)this.options=c=$.extend({srcs:[],pipesize:0,delay:100},b),c.pipesize?this.loader=new a.ChainLoader(c.pipesize,c.delay):this.loader=new a.BasicLoader,$.each(c.srcs,function(b,c){return d.loader.add(new a.LoaderItem(c))});else return new a.LoaderFacade(b)}var b,d=this;return b=["bind","trigger","load","one","unbind","add","kill"],$.each(b,function(a,b){return e.prototype[b]=function(){var a;return a=1<=arguments.length?c.call(arguments,0):[],this.loader[b].apply(this.loader,a)}}),e}.call(this),function(){var c,d,e,f,g;return e={},c=null,d=function(){return $.Deferred(function(a){return $(function(){return c=$('<div id="calcNaturalWH-tempholder"></div>').css({position:"absolute",left:"-9999px",top:"-9999px"}),$("body").append(c),a.resolve()})}).promise()},f=function(a){return a.naturalWidth===void 0||a.naturalWidth===0||a.naturalHeight===void 0||a.naturalHeight===0?!1:!0},g=function(a,d){var f;return a=a.clone(),f=a[0],$.Deferred(function(g){var h,i,j,k;return k={},a.css({width:"auto",height:"auto"}),h=$("<div></div>").append(a),c.append(h),i=0,j=function(){return k.width=f.naturalWidth||a.width(),k.height=f.naturalHeight||a.height(),i>10?(h.remove(),g.reject()):!k.width||!k.height?(i++,b(100).done(function(){return j()})):(e[d],h.remove(),g.resolve(k))},j()}).promise()},a.calcNaturalWH=a.createCachedFunction(function(b,c){return a.loadImg(c).then(function(a){var h,i;return h=a[0],f(h)?(i={width:h.naturalWidth,height:h.naturalHeight},e[c]=i,b.resolve(i,a)):d().done(function(){return g(a,c).then(function(c){return b.resolve(c,a)},function(){return b.reject()})})},function(){return b.reject()})})}(),$.loadImg=a.loadImg,$.ImgLoader=a.LoaderFacade,$.calcNaturalWH=a.calcNaturalWH}).call(this);

/* my app code */

(function() {
  var AutoReloader, ListContainerView, ListViewSpinner, Manager, NewList, ReloadTimer, SearchForm, Tweet, TweetCollection, TweetListView, TweetView, TwitterSeach, TwitterSeachCollection, WidthChanger, api, deck, wait,
    __hasProp = Object.prototype.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor; child.__super__ = parent.prototype; return child; },
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

  deck = $.TmplDeck('templates.html');

  $.fn.linkBlankify = function() {
    return this.each(function() {
      return $(this).find('a').each(function() {
        return $(this).attr('target', '_blank');
      });
    });
  };

  $.fn.shake = function() {
    return this.each(function() {
      var n;
      n = 30;
      return $(this).stop().animate({
        left: "-6px"
      }, n).animate({
        left: "6px"
      }, n).animate({
        left: "-6px"
      }, n).animate({
        left: "6px"
      }, n).animate({
        left: "0px"
      }, n);
    });
  };

  wait = function(milli) {
    return $.Deferred(function(defer) {
      return setTimeout(function() {
        return defer.resolve();
      }, milli || 0);
    }).promise();
  };

  twttr.formatDate = function(dateString) {
    var d, date, hour, min, month, ret, year;
    d = new Date(dateString);
    year = d.getFullYear();
    if (year !== year) {
      d = new Date(dateString.replace(/^([^ ]+) ([^ ]+) ([^ ]+) ([^ ]+) ([^ ]+) ([^ ]+)$/, '$1, $3 $2 $6 $4 $5'));
      year = d.getFullYear();
    }
    month = d.getMonth() + 1;
    date = d.getDate();
    hour = d.getHours();
    min = d.getMinutes();
    return ret = "" + year + "/" + month + "/" + date + " " + hour + ":" + min;
  };

  api = {};

  api.searchTweets = function(query) {
    var req, ret;
    req = null;
    ret = $.Deferred(function(defer) {
      return req = $.ajax({
        url: 'http://search.twitter.com/search.json',
        dataType: 'jsonp',
        data: {
          result_type: 'recent',
          rpp: 100,
          page: 1,
          q: query
        }
      }).pipe(function(res) {
        return defer.resolve(res);
      }, function() {
        return defer.reject();
      }).always(function() {
        return req = null;
      });
    }).promise();
    ret.abort = function() {
      if (req != null) req.abort();
      return ret;
    };
    return ret;
  };

  Manager = (function() {

    function Manager() {}

    _.extend(Manager.prototype, Backbone.Events);

    Manager.prototype.add = function(item) {
      if (this.items == null) this.items = [];
      this.items.push(item);
      return this.trigger('sizechange', this.size());
    };

    Manager.prototype.reset = function() {
      this.items = [];
      return this;
    };

    Manager.prototype.size = function() {
      if (this.items) {
        return this.items.length;
      } else {
        return 0;
      }
    };

    Manager.prototype.remove = function(item) {
      this.items = _.without(this.items, item);
      this.trigger('sizechange', this.size());
      return this;
    };

    return Manager;

  })();

  Tweet = (function(_super) {

    __extends(Tweet, _super);

    function Tweet() {
      Tweet.__super__.constructor.apply(this, arguments);
    }

    return Tweet;

  })(Backbone.Model);

  TweetCollection = (function(_super) {

    __extends(TweetCollection, _super);

    function TweetCollection() {
      TweetCollection.__super__.constructor.apply(this, arguments);
    }

    TweetCollection.prototype.model = Tweet;

    TweetCollection.prototype.meta = null;

    return TweetCollection;

  })(Backbone.Collection);

  TwitterSeach = (function(_super) {

    __extends(TwitterSeach, _super);

    function TwitterSeach() {
      TwitterSeach.__super__.constructor.apply(this, arguments);
    }

    TwitterSeach.prototype.update = function() {
      var _this = this;
      this.trigger('searchstart');
      this.updateDefer = api.searchTweets(this.get('query'));
      this.updateDefer.pipe(function(res) {
        _this.tweets = new TweetCollection(res.results);
        return _this.trigger('success');
      }, function() {
        return _this.trigger('error');
      });
      return this.updateDefer;
    };

    TwitterSeach.prototype.destroy = function() {
      var _ref;
      if ((_ref = this.updateDefer) != null) _ref.abort();
      TwitterSeach.__super__.destroy.apply(this, arguments);
      return this;
    };

    return TwitterSeach;

  })(Backbone.Model);

  TwitterSeachCollection = (function(_super) {

    __extends(TwitterSeachCollection, _super);

    function TwitterSeachCollection() {
      TwitterSeachCollection.__super__.constructor.apply(this, arguments);
    }

    TwitterSeachCollection.prototype.model = TwitterSeach;

    TwitterSeachCollection.prototype.localStorage = new Store('twittersearch');

    TwitterSeachCollection.prototype.loadCached = function() {
      var _this = this;
      return _.each(this.localStorage.findAll(), function(data) {
        return _this.add(data);
      });
    };

    TwitterSeachCollection.prototype.updateCache = function(twitterSearch) {
      if (this.localStorage.find(twitterSearch)) {
        this.localStorage.update(twitterSearch);
      } else {
        this.localStorage.create(twitterSearch);
      }
      this.localStorage.save();
      return this;
    };

    TwitterSeachCollection.prototype.add = function(options) {
      var twitterSearch;
      twitterSearch = new this.model(options);
      TwitterSeachCollection.__super__.add.call(this, twitterSearch);
      this.updateCache(twitterSearch);
      return this;
    };

    TwitterSeachCollection.prototype.updateAllSearches = function() {
      this.each(function(model) {
        return model.update();
      });
      return this;
    };

    return TwitterSeachCollection;

  })(Backbone.Collection);

  window.TwitterSearches = new TwitterSeachCollection;

  ListViewSpinner = (function() {

    function ListViewSpinner($parent) {
      var options, spinner;
      options = {
        color: '#fff',
        length: 20,
        radius: 30
      };
      spinner = (new Spinner(options)).spin($parent[0]);
      this.el = spinner.el;
      this.$el = $(spinner.el);
    }

    return ListViewSpinner;

  })();

  TweetView = (function(_super) {

    __extends(TweetView, _super);

    function TweetView() {
      TweetView.__super__.constructor.apply(this, arguments);
    }

    TweetView.prototype.className = 'mod-tweetitem';

    TweetView.prototype.render = function() {
      this.$el.html(deck.tmpl('TweetView', this.model.toJSON()));
      return this;
    };

    return TweetView;

  })(Backbone.View);

  WidthChanger = (function(_super) {

    __extends(WidthChanger, _super);

    function WidthChanger() {
      WidthChanger.__super__.constructor.apply(this, arguments);
    }

    WidthChanger.prototype.options = {
      widthPerItem: 300
    };

    WidthChanger.prototype.initialize = function() {
      return this.update(1);
    };

    WidthChanger.prototype.update = function(size) {
      return this.$el.width(this.options.widthPerItem * (size + 1));
    };

    return WidthChanger;

  })(Backbone.View);

  NewList = (function(_super) {

    __extends(NewList, _super);

    function NewList() {
      this.toggle = __bind(this.toggle, this);
      NewList.__super__.constructor.apply(this, arguments);
    }

    NewList.prototype.events = {
      'click .mod-newlist-btn': 'toggle'
    };

    NewList.prototype.initialize = function() {
      return this.els = {
        content_closed: this.$('.mod-newlist-content-closed'),
        content_opened: this.$('.mod-newlist-content-opened')
      };
    };

    NewList.prototype.toggle = function() {
      return this.$el.toggleClass('state-close state-open');
    };

    return NewList;

  })(Backbone.View);

  SearchForm = (function(_super) {

    __extends(SearchForm, _super);

    function SearchForm() {
      this._submitHandler = __bind(this._submitHandler, this);
      SearchForm.__super__.constructor.apply(this, arguments);
    }

    SearchForm.prototype.events = {
      'submit': '_submitHandler'
    };

    SearchForm.prototype.initialize = function() {
      return this.els = {
        input: this.$('input[type=search]')
      };
    };

    SearchForm.prototype._submitHandler = function(e) {
      var val;
      e.preventDefault();
      val = this.els.input.val();
      if (!val) return;
      return this.trigger('submit', val);
    };

    return SearchForm;

  })(Backbone.View);

  TweetListView = (function(_super) {

    __extends(TweetListView, _super);

    function TweetListView() {
      TweetListView.__super__.constructor.apply(this, arguments);
    }

    TweetListView.prototype.className = 'mod-tweetlist';

    TweetListView.prototype.events = {
      'click .mod-tweetlist-util-reload': 'reload',
      'click .mod-tweetlist-remove': 'remove'
    };

    TweetListView.prototype.initialize = function() {
      this.els = {};
      return this.manager = new Manager;
    };

    TweetListView.prototype.refreshTweets = function() {
      var _this = this;
      this.model.tweets.each(function(tweet) {
        var view;
        view = new TweetView({
          model: tweet
        });
        _this.manager.add(view);
        return _this.els.bd.append((view.render().el));
      });
      return this;
    };

    TweetListView.prototype.renderLoading = function() {
      var _this = this;
      this.$el.html(deck.tmpl('TweetListView-frame', this.model.toJSON()));
      this.els.bd = this.$('.mod-tweetlist-bd');
      wait(0).done(function() {
        var spinner;
        spinner = new ListViewSpinner(_this.els.bd);
        return _this.els.spinner = spinner.$el;
      });
      return this;
    };

    TweetListView.prototype.renderContent = function() {
      var _this = this;
      this.els.spinner.fadeOut(function() {
        _this.els.spinner.remove();
        _this.refreshTweets();
        return _this.els.bd.hide().fadeIn().linkBlankify();
      });
      return this;
    };

    TweetListView.prototype.renderError = function() {
      this.$el.html(deck.tmpl('TweetListView-error'));
      return this;
    };

    TweetListView.prototype.reload = function() {
      return this.model.update();
    };

    TweetListView.prototype.remove = function() {
      var _this = this;
      this.$el.fadeOut(400, 'easeOutExpo', function() {
        _this.model.destroy();
        _this.$el.remove();
        return _this.trigger('remove', _this);
      });
      return this;
    };

    return TweetListView;

  })(Backbone.View);

  ListContainerView = (function(_super) {

    __extends(ListContainerView, _super);

    function ListContainerView() {
      this.addOne = __bind(this.addOne, this);
      ListContainerView.__super__.constructor.apply(this, arguments);
    }

    ListContainerView.prototype.initialize = function() {
      var _this = this;
      this.manager = new Manager;
      this.els = {
        inner: this.$('.mod-listcontainer-inner'),
        items: this.$('.mod-listcontainer-items')
      };
      this.widthChanger = new WidthChanger({
        el: this.els.inner
      });
      this.manager.bind('sizechange', function(size) {
        return _this.widthChanger.update(size);
      });
      return TwitterSearches.bind('add', this.addOne);
    };

    ListContainerView.prototype.addOne = function(twitterSearch) {
      var model, view,
        _this = this;
      model = twitterSearch;
      view = new TweetListView({
        model: model
      });
      this.manager.add(view);
      view.bind('remove', function() {
        return _this.manager.remove(view);
      });
      model.bind('searchstart', function() {
        return view.renderLoading();
      });
      model.bind('success', function() {
        return view.renderContent();
      });
      model.bind('error', function() {
        return view.renderError();
      });
      model.update();
      this.els.items.append(view.el);
      return this;
    };

    return ListContainerView;

  })(Backbone.View);

  ReloadTimer = (function() {

    _.extend(ReloadTimer.prototype, Backbone.Events);

    ReloadTimer.prototype._tickDefer = null;

    function ReloadTimer(interval) {
      this.interval = this.counter = interval;
    }

    ReloadTimer.prototype.tick = function() {
      var currentTick,
        _this = this;
      currentTick = {
        paused: false,
        tick: function() {
          return wait(1000).done(function() {
            if (currentTick.paused) return;
            _this.counter--;
            _this.trigger('tick', _this.counter);
            if (_this.counter === 0) {
              _this.counter = _this.interval + 1;
              _this.trigger('hitzero');
            }
            return _this.tick();
          });
        },
        destroy: function() {
          return currentTick.paused = true;
        }
      };
      currentTick.tick();
      this._currentTick = currentTick;
      return this;
    };

    ReloadTimer.prototype.resume = function() {
      var _ref;
      if ((_ref = this._currentTick) != null) _ref.destroy();
      this.tick();
      return this;
    };

    ReloadTimer.prototype.pause = function() {
      var _ref;
      if ((_ref = this._currentTick) != null) _ref.destroy();
      return this;
    };

    ReloadTimer.prototype.reset = function(interval) {
      if (interval) this.interval = interval;
      this.counter = this.interval + 1;
      return this;
    };

    return ReloadTimer;

  })();

  AutoReloader = (function(_super) {

    __extends(AutoReloader, _super);

    function AutoReloader() {
      this._keydownHandler = __bind(this._keydownHandler, this);
      this.escInput = __bind(this.escInput, this);
      this.toInput = __bind(this.toInput, this);
      AutoReloader.__super__.constructor.apply(this, arguments);
    }

    AutoReloader.prototype.events = {
      'focus': 'toInput',
      'blur': 'escInput',
      'keydown': '_keydownHandler'
    };

    AutoReloader.prototype.initialize = function() {
      var interval,
        _this = this;
      interval = 360;
      this.timer = new ReloadTimer(interval);
      this.$el.val(interval);
      this.timer.bind('tick', function(time) {
        return _this.$el.val(time);
      });
      this.timer.bind('hitzero', function() {
        return _this.trigger('hitzero');
      });
      return this.timer.resume();
    };

    AutoReloader.prototype.toInput = function() {
      this._lastVal = this.$el.val();
      this.$el.addClass('state-input');
      this.timer.pause();
      return this;
    };

    AutoReloader.prototype.escInput = function() {
      var num, val;
      this.$el.removeClass('state-input');
      val = this.$el.val();
      if (val !== this._lastVal) {
        if (/^\d+$/.test(val)) {
          num = parseInt(val, 10);
          this.timer.reset(num);
        } else {
          this.$el.shake();
          this.$el.val(this.timer.counter);
        }
      }
      this.timer.resume();
      return this;
    };

    AutoReloader.prototype.reset = function() {
      return this.timer.reset();
    };

    AutoReloader.prototype._keydownHandler = function(e) {
      if (e.keyCode === 13) this.$el.trigger('blur');
      return this;
    };

    return AutoReloader;

  })(Backbone.View);

  deck.load().done(function() {
    return $(function() {
      var autoreloader, listcontainer, newlist, searchform;
      newlist = new NewList({
        el: $('#newlist')
      });
      listcontainer = new ListContainerView({
        el: $('#listcontainer')
      });
      searchform = new SearchForm({
        el: $('#searchform')
      });
      autoreloader = new AutoReloader({
        el: $('#autoreloader')
      });
      searchform.bind('submit', function(query) {
        return TwitterSearches.add({
          query: query
        });
      });
      TwitterSearches.loadCached();
      autoreloader.bind('hitzero', function() {
        return TwitterSearches.updateAllSearches();
      });
      return $('#reloadall').click(function() {
        autoreloader.reset();
        return TwitterSearches.updateAllSearches();
      });
    });
  });

}).call(this);
